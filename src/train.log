[2022-12-21 17:38:58,199][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2022-12-21 17:38:58,203][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2022-12-21 17:38:58,203][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2022-12-21 17:38:58,238][__main__][INFO] - Instantiating datamodule <src.datamodules.mnist_datamodule.MNISTDataModule>
[2022-12-21 17:38:58,241][__main__][INFO] - Instantiating model <src.models.mnist_module.MNISTLitModule>
[2022-12-21 17:38:58,270][__main__][INFO] - Instantiating callbacks...
[2022-12-21 17:38:58,270][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2022-12-21 17:38:58,278][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2022-12-21 17:38:58,278][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2022-12-21 17:38:58,279][src.utils.utils][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2022-12-21 17:38:58,279][__main__][INFO] - Instantiating loggers...
[2022-12-21 17:38:58,280][src.utils.utils][WARNING] - No logger configs found! Skipping...
[2022-12-21 17:38:58,280][__main__][INFO] - Instantiating trainer <pytorch_lightning.Trainer>
[2022-12-21 17:38:58,340][__main__][INFO] - Starting training!
[2022-12-21 17:39:03,212][__main__][INFO] - Starting testing!
[2022-12-21 17:39:03,212][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2022-12-21 17:39:07,662][__main__][INFO] - Best ckpt path: None
[2022-12-21 17:39:07,663][src.utils.utils][INFO] - Output dir: /home/dan/lightning-hydra-template/logs/train/runs/2022-12-21_17-38-58
[2022-12-21 17:39:07,663][src.utils.utils][INFO] - Closing loggers...
[2022-12-21 17:39:07,663][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-12 17:59:39,864][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 17:59:39,868][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 17:59:39,869][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-12 17:59:39,939][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-12 17:59:40,164][__main__][INFO] - Instantiating model <src.MultiLabel.models.LLM_module.LLMLitModule>
[2023-04-12 17:59:40,690][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'scheduler'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.models.LLM_module.LLMLitModule':
TypeError("__init__() got an unexpected keyword argument 'scheduler'")
full_key: model
[2023-04-12 17:59:40,691][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-12_17-59-39
[2023-04-12 18:03:23,207][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 18:03:23,213][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 18:03:23,214][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-12 18:03:23,270][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-12 18:03:23,446][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-12 18:03:23,802][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 54, in __init__
    self.map_val = AveragePrecision(task='multilabel', average='macro', num_labels=self.classes)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'Resnet50' object has no attribute 'classes'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.models.Resnet50_module.Resnet50':
AttributeError("'Resnet50' object has no attribute 'classes'")
full_key: model
[2023-04-12 18:03:23,804][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-12_18-03-23
[2023-04-12 18:04:02,479][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 18:04:02,483][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 18:04:02,483][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-12 18:04:02,527][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-12 18:04:02,681][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-12 18:04:03,053][__main__][INFO] - Instantiating callbacks...
[2023-04-12 18:04:03,054][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-12 18:04:03,056][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-12 18:04:03,057][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-12 18:04:03,057][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-12 18:04:03,057][__main__][INFO] - Instantiating loggers...
[2023-04-12 18:04:03,058][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-12 18:04:03,058][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-12 18:04:03,222][__main__][INFO] - Starting training!
[2023-04-12 18:04:09,834][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 97, in validation_step
    loss, preds, targets, correction_idx = self.model_step(batch)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 78, in model_step
    loss, correction_idx = self.criterion(logits, noisy_labels, self.clean_rate, self.hparams.mod_scheme,
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'Resnet50' object has no attribute 'clean_rate'
[2023-04-12 18:04:09,837][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-12_18-04-02
[2023-04-12 18:06:48,410][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-12 18:06:48,414][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-12 18:06:48,414][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-12 18:06:48,462][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-12 18:06:48,614][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-12 18:06:48,967][__main__][INFO] - Instantiating callbacks...
[2023-04-12 18:06:48,967][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-12 18:06:48,969][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-12 18:06:48,970][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-12 18:06:48,971][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-12 18:06:48,971][__main__][INFO] - Instantiating loggers...
[2023-04-12 18:06:48,971][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-12 18:06:48,971][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-12 18:06:49,098][__main__][INFO] - Starting training!
[2023-04-12 18:06:55,490][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 96, in validation_step
    loss, preds, targets, correction_idx = self.model_step(batch)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 78, in model_step
    loss, correction_idx = self.criterion(logits, noisy_labels)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/_tensor.py", line 930, in __iter__
    raise TypeError("iteration over a 0-d tensor")
TypeError: iteration over a 0-d tensor
[2023-04-12 18:06:55,492][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-12_18-06-48
[2023-04-14 11:30:33,311][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 11:30:33,315][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 11:30:33,315][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 11:30:33,376][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 11:30:33,540][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 11:30:34,122][__main__][INFO] - Instantiating callbacks...
[2023-04-14 11:30:34,122][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 11:30:34,125][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 11:30:34,126][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 11:30:34,126][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 11:30:34,127][__main__][INFO] - Instantiating loggers...
[2023-04-14 11:30:34,127][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 11:30:34,127][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 11:30:34,336][__main__][INFO] - Starting training!
[2023-04-14 11:30:41,086][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 96, in validation_step
    loss, preds, targets, correction_idx = self.model_step(batch)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 78, in model_step
    loss, correction_idx = self.criterion(logits, noisy_labels)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/_tensor.py", line 930, in __iter__
    raise TypeError("iteration over a 0-d tensor")
TypeError: iteration over a 0-d tensor
[2023-04-14 11:30:41,089][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-14_11-30-33
[2023-04-14 11:43:57,113][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 11:43:57,117][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 11:43:57,117][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 11:43:57,161][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 11:43:57,314][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 11:43:57,708][__main__][INFO] - Instantiating callbacks...
[2023-04-14 11:43:57,708][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 11:43:57,710][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 11:43:57,711][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 11:43:57,712][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 11:43:57,712][__main__][INFO] - Instantiating loggers...
[2023-04-14 11:43:57,712][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 11:43:57,713][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 11:43:57,918][__main__][INFO] - Starting training!
[2023-04-14 11:44:04,365][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 101, in validation_step
    self.val_auroc(preds, targets)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/classification/precision_recall_curve.py", line 412, in update
    _multilabel_precision_recall_curve_tensor_validation(preds, target, self.num_labels, self.ignore_index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/functional/classification/precision_recall_curve.py", line 580, in _multilabel_precision_recall_curve_tensor_validation
    _binary_precision_recall_curve_tensor_validation(preds, target, ignore_index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/functional/classification/precision_recall_curve.py", line 136, in _binary_precision_recall_curve_tensor_validation
    raise ValueError(
ValueError: Expected argument `target` to be an int or long tensor with ground truth labels but got tensor with dtype torch.float64
[2023-04-14 11:44:04,368][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-14_11-43-57
[2023-04-14 11:45:13,926][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 11:45:13,930][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 11:45:13,930][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 11:45:13,976][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 11:45:14,151][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 11:45:14,527][__main__][INFO] - Instantiating callbacks...
[2023-04-14 11:45:14,527][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 11:45:14,529][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 11:45:14,531][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 11:45:14,531][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 11:45:14,532][__main__][INFO] - Instantiating loggers...
[2023-04-14 11:45:14,532][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 11:45:14,532][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 11:45:14,746][__main__][INFO] - Starting training!
[2023-04-14 11:46:28,727][__main__][INFO] - Starting testing!
[2023-04-14 11:46:28,728][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-04-14 11:46:32,102][__main__][INFO] - Best ckpt path: None
[2023-04-14 11:46:32,105][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-14_11-45-13
[2023-04-14 11:46:32,106][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-14 11:47:42,561][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 11:47:42,564][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 11:47:42,565][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 11:47:42,610][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 11:47:42,762][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 11:47:43,118][__main__][INFO] - Instantiating callbacks...
[2023-04-14 11:47:43,118][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 11:47:43,120][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 11:47:43,121][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 11:47:43,122][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 11:47:43,122][__main__][INFO] - Instantiating loggers...
[2023-04-14 11:47:43,122][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 11:47:43,122][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 11:47:43,325][__main__][INFO] - Starting training!
[2023-04-14 11:47:43,542][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2023-04-14 11:47:43,542][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 1 nodes.
[2023-04-14 11:48:39,161][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 11:48:39,165][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 11:48:39,165][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 11:48:39,216][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 11:48:39,374][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 11:48:39,732][__main__][INFO] - Instantiating callbacks...
[2023-04-14 11:48:39,732][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 11:48:39,734][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 11:48:39,735][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 11:48:39,735][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 11:48:39,736][__main__][INFO] - Instantiating loggers...
[2023-04-14 11:48:39,736][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 11:48:39,736][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 11:48:39,953][__main__][INFO] - Starting training!
[2023-04-14 13:04:07,633][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 13:04:07,638][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 13:04:07,638][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 13:04:07,679][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 13:04:07,833][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 13:04:08,194][__main__][INFO] - Instantiating callbacks...
[2023-04-14 13:04:08,195][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 13:04:08,197][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 13:04:08,198][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 13:04:08,198][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 13:04:08,199][__main__][INFO] - Instantiating loggers...
[2023-04-14 13:04:08,199][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 13:04:08,199][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 13:04:08,371][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/argparse.py", line 69, in insert_env_defaults
    return fn(self, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 393, in __init__
    self._accelerator_connector = _AcceleratorConnector(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py", line 154, in __init__
    self._accelerator_flag = self._choose_gpu_accelerator_backend()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/connectors/accelerator_connector.py", line 371, in _choose_gpu_accelerator_backend
    raise MisconfigurationException("No supported gpu backend found!")
lightning_fabric.utilities.exceptions.MisconfigurationException: No supported gpu backend found!

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 66, in train
    trainer: Trainer = hydra.utils.instantiate(cfg.trainer, callbacks=callbacks, logger=logger)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'pytorch_lightning.trainer.trainer.Trainer':
MisconfigurationException('No supported gpu backend found!')
full_key: trainer
[2023-04-14 13:04:08,373][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-14_13-04-07
[2023-04-14 13:10:56,354][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 13:10:56,363][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 13:10:56,364][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 13:10:56,474][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 13:10:56,850][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 13:10:57,761][__main__][INFO] - Instantiating callbacks...
[2023-04-14 13:10:57,762][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 13:10:57,765][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 13:10:57,767][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 13:10:57,768][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 13:10:57,769][__main__][INFO] - Instantiating loggers...
[2023-04-14 13:10:57,769][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 13:10:57,769][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 13:10:58,061][__main__][INFO] - Starting training!
[2023-04-14 17:52:57,949][__main__][INFO] - Starting testing!
[2023-04-14 17:53:01,827][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 97, in train
    trainer.test(model=model, datamodule=datamodule, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 706, in test
    return call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 749, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 971, in _run_stage
    return self._evaluation_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 387, in test_step
    return self.model.test_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 128, in test_step
    self.test_auroc(preds, targets)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/classification/precision_recall_curve.py", line 412, in update
    _multilabel_precision_recall_curve_tensor_validation(preds, target, self.num_labels, self.ignore_index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/functional/classification/precision_recall_curve.py", line 580, in _multilabel_precision_recall_curve_tensor_validation
    _binary_precision_recall_curve_tensor_validation(preds, target, ignore_index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/functional/classification/precision_recall_curve.py", line 136, in _binary_precision_recall_curve_tensor_validation
    raise ValueError(
ValueError: Expected argument `target` to be an int or long tensor with ground truth labels but got tensor with dtype torch.float64
[2023-04-14 17:53:01,841][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-14_13-10-56
[2023-04-14 17:53:30,486][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-14 17:53:30,494][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-14 17:53:30,494][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-14 17:53:30,568][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-14 17:53:30,876][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-14 17:53:31,588][__main__][INFO] - Instantiating callbacks...
[2023-04-14 17:53:31,589][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-14 17:53:31,594][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-14 17:53:31,596][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-14 17:53:31,597][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-14 17:53:31,598][__main__][INFO] - Instantiating loggers...
[2023-04-14 17:53:31,598][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-14 17:53:31,599][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-14 17:53:31,781][__main__][INFO] - Starting training!
[2023-04-14 22:25:50,554][__main__][INFO] - Starting testing!
[2023-04-14 22:33:21,413][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-04-14_17-53-30/checkpoints/epoch_007.ckpt
[2023-04-14 22:33:21,416][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-14_17-53-30
[2023-04-14 22:33:21,416][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-17 13:34:39,610][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 13:40:53,195][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 13:41:57,567][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 13:47:29,116][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 13:47:29,120][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 13:47:29,120][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-17 13:47:29,181][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-17 13:47:29,396][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'mini_dataset'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 54, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule':
TypeError("__init__() got an unexpected keyword argument 'mini_dataset'")
full_key: data
[2023-04-17 13:47:29,397][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-17_13-47-29
[2023-04-17 13:56:57,607][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 13:56:57,611][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 13:56:57,611][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-17 13:56:57,652][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-17 13:56:57,807][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-17 13:56:58,384][__main__][INFO] - Instantiating callbacks...
[2023-04-17 13:56:58,385][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 13:56:58,387][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-17 13:56:58,388][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 13:56:58,388][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 13:56:58,389][__main__][INFO] - Instantiating loggers...
[2023-04-17 13:56:58,389][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-17 13:56:58,389][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-17 13:56:58,521][__main__][INFO] - Starting training!
[2023-04-17 14:12:45,759][__main__][INFO] - Starting testing!
[2023-04-17 14:12:45,759][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-04-17 14:12:48,130][__main__][INFO] - Best ckpt path: None
[2023-04-17 14:12:48,135][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-17_13-56-57
[2023-04-17 14:12:48,136][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-17 14:27:02,554][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 14:27:02,558][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 14:27:02,558][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-17 14:27:02,598][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-17 14:27:02,753][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-17 14:27:03,107][__main__][INFO] - Instantiating callbacks...
[2023-04-17 14:27:03,108][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 14:27:03,110][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-17 14:27:03,111][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 14:27:03,111][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 14:27:03,111][__main__][INFO] - Instantiating loggers...
[2023-04-17 14:27:03,112][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-17 14:27:03,112][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-17 14:27:03,244][__main__][INFO] - Starting training!
[2023-04-17 14:27:04,225][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 108, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 136, in __next__
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 150, in _fetch_next_batch
    batch = next(iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 276, in __next__
    out = next(self._iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 122, in __next__
    out = next(self.iterators[self._iterator_idx])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 92, in __getitem__
    with Image.open(image_path) as I_raw:
  File "/home/dan/anaconda3/lib/python3.9/site-packages/PIL/Image.py", line 3092, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '/home/dan/LabelNoise/data/MultiLabel/coco/train2017/COCO_train2017_000000100064.jpg'

[2023-04-17 14:27:04,228][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-17_14-27-02
[2023-04-17 14:31:35,011][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 14:31:35,015][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 14:31:35,015][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-17 14:31:35,054][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-17 14:31:35,212][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-17 14:31:35,563][__main__][INFO] - Instantiating callbacks...
[2023-04-17 14:31:35,564][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 14:31:35,566][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-17 14:31:35,567][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 14:31:35,567][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 14:31:35,568][__main__][INFO] - Instantiating loggers...
[2023-04-17 14:31:35,568][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-17 14:31:35,568][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-17 14:31:35,705][__main__][INFO] - Starting training!
[2023-04-17 14:31:36,003][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 186, in setup
    data[phase]['labels'] = np.load(os.path.join(self.anno_dir, 'formatted_{}_labels.npy'.format(phase)))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/numpy/lib/npyio.py", line 417, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: '/home/dan/LabelNoise/data/MultiLabel/coco/annotations/mini2017/formatted_train_labels.npy'
[2023-04-17 14:31:36,004][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-17_14-31-34
[2023-04-17 14:32:30,371][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 14:32:30,375][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 14:32:30,375][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-17 14:32:30,413][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-17 14:32:30,567][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-17 14:32:30,923][__main__][INFO] - Instantiating callbacks...
[2023-04-17 14:32:30,923][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 14:32:30,925][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-17 14:32:30,926][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 14:32:30,927][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 14:32:30,927][__main__][INFO] - Instantiating loggers...
[2023-04-17 14:32:30,927][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-17 14:32:30,927][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-17 14:32:31,059][__main__][INFO] - Starting training!
[2023-04-17 14:32:32,095][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 108, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 136, in __next__
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 150, in _fetch_next_batch
    batch = next(iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 276, in __next__
    out = next(self._iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 122, in __next__
    out = next(self.iterators[self._iterator_idx])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 92, in __getitem__
    with Image.open(image_path) as I_raw:
  File "/home/dan/anaconda3/lib/python3.9/site-packages/PIL/Image.py", line 3092, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '/home/dan/LabelNoise/data/MultiLabel/coco/train2017/000000100395.jpg'

[2023-04-17 14:32:32,099][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-17_14-32-30
[2023-04-17 15:19:10,978][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 15:19:10,982][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 15:19:10,982][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-17 15:19:11,025][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-17 15:19:11,188][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-17 15:19:11,575][__main__][INFO] - Instantiating callbacks...
[2023-04-17 15:19:11,575][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 15:19:11,578][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-17 15:19:11,579][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 15:19:11,580][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 15:19:11,580][__main__][INFO] - Instantiating loggers...
[2023-04-17 15:19:11,581][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-17 15:19:11,581][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-17 15:19:11,719][__main__][INFO] - Starting training!
[2023-04-17 15:19:12,742][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 108, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 136, in __next__
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 150, in _fetch_next_batch
    batch = next(iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 276, in __next__
    out = next(self._iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 122, in __next__
    out = next(self.iterators[self._iterator_idx])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
FileNotFoundError: Caught FileNotFoundError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 92, in __getitem__
    with Image.open(image_path) as I_raw:
  File "/home/dan/anaconda3/lib/python3.9/site-packages/PIL/Image.py", line 3092, in open
    fp = builtins.open(filename, "rb")
FileNotFoundError: [Errno 2] No such file or directory: '/home/dan/LabelNoise/data/MultiLabel/coco/coco_mini/coco_minitrain_25k/train2017/000000100064.jpg'

[2023-04-17 15:19:12,745][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-17_15-19-10
[2023-04-17 15:20:19,024][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-17 15:20:19,028][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-17 15:20:19,029][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-17 15:20:19,071][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-17 15:20:19,233][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-17 15:20:19,621][__main__][INFO] - Instantiating callbacks...
[2023-04-17 15:20:19,622][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-17 15:20:19,625][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-17 15:20:19,626][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-17 15:20:19,626][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-17 15:20:19,627][__main__][INFO] - Instantiating loggers...
[2023-04-17 15:20:19,627][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-17 15:20:19,627][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-17 15:20:19,764][__main__][INFO] - Starting training!
[2023-04-17 16:45:10,724][__main__][INFO] - Starting testing!
[2023-04-17 16:46:08,234][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-04-17_15-20-18/checkpoints/epoch_009.ckpt
[2023-04-17 16:46:08,236][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-17_15-20-18
[2023-04-17 16:46:08,236][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-19 17:12:46,835][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-19 17:12:46,839][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-19 17:12:46,839][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-19 17:12:46,887][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-19 17:12:47,045][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-19 17:12:47,412][__main__][INFO] - Instantiating callbacks...
[2023-04-19 17:12:47,412][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-19 17:12:47,415][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-19 17:12:47,416][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-19 17:12:47,416][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-19 17:12:47,417][__main__][INFO] - Instantiating loggers...
[2023-04-19 17:12:47,417][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-19 17:12:47,417][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-19 17:12:47,552][__main__][INFO] - Starting training!
[2023-04-19 17:12:55,426][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 978, in _run_stage
    self.fit_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 201, in run
    self.advance()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fit_loop.py", line 354, in advance
    self.epoch_loop.run(self._data_fetcher)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 133, in run
    self.advance(data_fetcher)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/training_epoch_loop.py", line 218, in advance
    batch_output = self.automatic_optimization.run(trainer.optimizers[0], kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 185, in run
    self._optimizer_step(kwargs.get("batch_idx", 0), closure)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 261, in _optimizer_step
    call._call_lightning_module_hook(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 142, in _call_lightning_module_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/core/module.py", line 1265, in optimizer_step
    optimizer.step(closure=optimizer_closure)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/core/optimizer.py", line 158, in step
    step_output = self._strategy.optimizer_step(self._optimizer, closure, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 224, in optimizer_step
    return self.precision_plugin.optimizer_step(optimizer, model=model, closure=closure, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 114, in optimizer_step
    return optimizer.step(closure=closure, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/optim/optimizer.py", line 280, in wrapper
    out = func(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/optim/optimizer.py", line 33, in _use_grad
    ret = func(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/optim/adam.py", line 121, in step
    loss = closure()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/plugins/precision/precision_plugin.py", line 101, in _wrap_closure
    closure_result = closure()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 140, in __call__
    self._result = self.closure(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 126, in closure
    step_output = self._step_fn()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/optimization/automatic.py", line 308, in _training_step
    training_step_output = call._call_strategy_hook(trainer, "training_step", *kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 366, in training_step
    return self.model.training_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 84, in training_step
    loss, preds, targets = self.model_step(batch)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 72, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/Resnet50_module.py", line 61, in forward
    return self.net(x)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/components/resnet50.py", line 57, in forward
    feats = self.feature_extractor(x)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchvision/models/resnet.py", line 154, in forward
    out = self.conv3(out)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 392.00 MiB (GPU 0; 11.90 GiB total capacity; 10.96 GiB already allocated; 243.44 MiB free; 10.98 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[2023-04-19 17:12:55,430][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-19_17-12-46
[2023-04-19 17:13:07,473][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-19 17:13:07,477][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-19 17:13:07,477][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-19 17:13:07,520][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-19 17:13:07,673][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-19 17:13:08,025][__main__][INFO] - Instantiating callbacks...
[2023-04-19 17:13:08,026][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-19 17:13:08,029][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-19 17:13:08,030][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-19 17:13:08,030][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-19 17:13:08,031][__main__][INFO] - Instantiating loggers...
[2023-04-19 17:13:08,031][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-19 17:13:08,031][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-19 17:13:08,164][__main__][INFO] - Starting training!
[2023-04-19 17:13:25,932][__main__][INFO] - Starting testing!
[2023-04-19 17:13:25,932][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-04-19 17:13:29,288][__main__][INFO] - Best ckpt path: None
[2023-04-19 17:13:29,289][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-19_17-13-07
[2023-04-19 17:13:29,290][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-19 17:13:40,672][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-19 17:13:40,676][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-19 17:13:40,676][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-19 17:13:40,716][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-19 17:13:40,875][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-19 17:13:41,241][__main__][INFO] - Instantiating callbacks...
[2023-04-19 17:13:41,242][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-19 17:13:41,244][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-19 17:13:41,245][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-19 17:13:41,245][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-19 17:13:41,246][__main__][INFO] - Instantiating loggers...
[2023-04-19 17:13:41,246][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-19 17:13:41,246][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-19 17:13:41,380][__main__][INFO] - Starting training!
[2023-04-19 17:13:41,689][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 216, in setup
    self.data_train = NoisyMultiLabel(image_names=data['train']['images'][split_idx['train']],
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 56, in __init__
    self.labels_ns = self.targets
AttributeError: 'NoisyMultiLabel' object has no attribute 'targets'
[2023-04-19 17:13:41,690][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-19_17-13-40
[2023-04-19 17:14:06,251][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-19 17:14:06,254][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-19 17:14:06,255][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-19 17:14:06,300][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-19 17:14:06,454][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-19 17:14:06,805][__main__][INFO] - Instantiating callbacks...
[2023-04-19 17:14:06,805][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-19 17:14:06,807][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-19 17:14:06,808][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-19 17:14:06,808][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-19 17:14:06,809][__main__][INFO] - Instantiating loggers...
[2023-04-19 17:14:06,809][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-19 17:14:06,809][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-19 17:14:06,942][__main__][INFO] - Starting training!
[2023-04-19 21:19:43,107][__main__][INFO] - Starting testing!
[2023-04-19 21:20:27,064][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-04-19_17-14-06/checkpoints/epoch_028.ckpt
[2023-04-19 21:20:27,065][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-19_17-14-06
[2023-04-19 21:20:27,065][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-20 10:13:15,063][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 10:13:15,067][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 10:13:15,067][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-20 10:13:15,105][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-20 10:13:15,263][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-20 10:13:15,622][__main__][INFO] - Instantiating callbacks...
[2023-04-20 10:13:15,622][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 10:13:15,624][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-20 10:13:15,625][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 10:13:15,625][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 10:13:15,626][__main__][INFO] - Instantiating loggers...
[2023-04-20 10:13:15,626][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-20 10:13:15,626][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-20 10:13:15,759][__main__][INFO] - Starting training!
[2023-04-20 10:13:16,052][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 216, in setup
    self.data_train = NoisyMultiLabel(image_names=data['train']['images'][split_idx['train']],
TypeError: __init__() got an unexpected keyword argument 'mode'
[2023-04-20 10:13:16,053][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-20_10-13-15
[2023-04-20 10:14:15,138][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 10:14:15,142][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 10:14:15,142][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-20 10:14:15,179][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-20 10:14:15,338][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-20 10:14:15,699][__main__][INFO] - Instantiating callbacks...
[2023-04-20 10:14:15,700][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 10:14:15,702][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-20 10:14:15,703][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 10:14:15,703][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 10:14:15,704][__main__][INFO] - Instantiating loggers...
[2023-04-20 10:14:15,704][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-20 10:14:15,704][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-20 10:14:15,840][__main__][INFO] - Starting training!
[2023-04-20 10:26:08,713][__main__][INFO] - Starting testing!
[2023-04-20 10:26:11,471][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-04-20_10-14-15/checkpoints/epoch_000.ckpt
[2023-04-20 10:26:11,474][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-20_10-14-15
[2023-04-20 10:26:11,475][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-20 10:30:19,758][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 10:30:19,761][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 10:30:19,762][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-20 10:30:19,800][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-20 10:30:19,955][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-20 10:30:20,324][__main__][INFO] - Instantiating callbacks...
[2023-04-20 10:30:20,324][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 10:30:20,326][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-20 10:30:20,327][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 10:30:20,327][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 10:30:20,328][__main__][INFO] - Instantiating loggers...
[2023-04-20 10:30:20,328][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-20 10:30:20,328][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-20 10:30:20,461][__main__][INFO] - Starting training!
[2023-04-20 12:18:34,577][__main__][INFO] - Starting testing!
[2023-04-20 12:19:20,072][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-04-20_10-30-19/checkpoints/epoch_008.ckpt
[2023-04-20 12:19:20,073][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-20_10-30-19
[2023-04-20 12:19:20,073][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-20 13:18:49,952][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 13:18:49,958][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 13:18:49,959][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-20 13:18:50,005][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-20 13:18:50,158][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-20 13:18:50,516][__main__][INFO] - Instantiating callbacks...
[2023-04-20 13:18:50,516][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 13:18:50,518][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-20 13:18:50,519][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 13:18:50,519][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 13:18:50,520][__main__][INFO] - Instantiating loggers...
[2023-04-20 13:18:50,520][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-20 13:18:50,520][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-20 13:18:50,654][__main__][INFO] - Starting training!
[2023-04-20 13:18:55,376][__main__][INFO] - Starting testing!
[2023-04-20 13:18:55,376][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-04-20 13:18:56,693][__main__][INFO] - Best ckpt path: None
[2023-04-20 13:18:56,694][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-20_13-18-49
[2023-04-20 13:18:56,694][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-20 13:19:29,881][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 13:19:29,885][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 13:19:29,885][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-20 13:19:29,922][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-20 13:19:30,079][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-20 13:19:30,439][__main__][INFO] - Instantiating callbacks...
[2023-04-20 13:19:30,439][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 13:19:30,441][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-20 13:19:30,442][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 13:19:30,442][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 13:19:30,443][__main__][INFO] - Instantiating loggers...
[2023-04-20 13:19:30,443][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-20 13:19:30,443][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-20 13:19:30,578][__main__][INFO] - Starting training!
[2023-04-20 14:41:55,182][__main__][INFO] - Starting testing!
[2023-04-20 14:42:45,316][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-04-20_13-19-29/checkpoints/epoch_005.ckpt
[2023-04-20 14:42:45,317][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-20_13-19-29
[2023-04-20 14:42:45,318][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-04-20 17:28:33,568][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:28:33,572][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:28:33,572][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-20 17:28:33,627][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-20 17:28:33,783][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-20 17:28:34,154][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:28:34,154][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:28:34,156][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-20 17:28:34,157][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:28:34,158][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:28:34,158][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:28:34,158][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-20 17:28:34,159][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-20 17:28:34,292][__main__][INFO] - Starting training!
[2023-04-20 17:28:34,592][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 231, in setup
    self.data_train = NoisyMultiLabel(image_names=data['train']['images'][split_idx['train']],
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 83, in __init__
    checkpoint = torch.load(checkpoint_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/serialization.py", line 791, in load
    with _open_file_like(f, 'rb') as opened_file:
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/serialization.py", line 271, in _open_file_like
    return _open_file(name_or_buffer, mode)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/serialization.py", line 252, in __init__
    super().__init__(open(name, mode))
FileNotFoundError: [Errno 2] No such file or directory: 'path/to/checkpoint.pth'
[2023-04-20 17:28:34,593][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-20_17-28-33
[2023-04-20 17:30:11,419][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-20 17:30:11,423][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-20 17:30:11,423][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-20 17:30:11,461][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-20 17:30:11,615][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-20 17:30:11,988][__main__][INFO] - Instantiating callbacks...
[2023-04-20 17:30:11,989][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-20 17:30:11,991][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-20 17:30:11,992][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-20 17:30:11,992][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-20 17:30:11,992][__main__][INFO] - Instantiating loggers...
[2023-04-20 17:30:11,993][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-20 17:30:11,993][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-20 17:30:12,130][__main__][INFO] - Starting training!
[2023-04-20 17:30:12,679][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 231, in setup
    self.data_train = NoisyMultiLabel(image_names=data['train']['images'][split_idx['train']],
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 85, in __init__
    model = Resnet50()  # Replace with your model class and any necessary arguments
TypeError: __init__() missing 4 required positional arguments: 'net', 'optimizer', 'scheduler', and 'num_classes'
[2023-04-20 17:30:12,680][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-20_17-30-11
[2023-04-21 09:27:41,118][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 09:27:41,122][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 09:27:41,122][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-21 09:27:41,166][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-21 09:27:41,331][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-21 09:27:41,706][__main__][INFO] - Instantiating callbacks...
[2023-04-21 09:27:41,707][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 09:27:41,709][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-21 09:27:41,711][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 09:27:41,711][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 09:27:41,712][__main__][INFO] - Instantiating loggers...
[2023-04-21 09:27:41,712][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-21 09:27:41,712][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-21 09:27:41,850][__main__][INFO] - Starting training!
[2023-04-21 09:27:42,424][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 241, in setup
    self.data_train = NoisyMultiLabel(image_names=data['train']['images'][split_idx['train']],
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 85, in __init__
    model = Resnet50()  # Replace with your model class and any necessary arguments
TypeError: __init__() missing 4 required positional arguments: 'net', 'optimizer', 'scheduler', and 'num_classes'
[2023-04-21 09:27:42,425][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-21_09-27-41
[2023-04-21 10:04:11,077][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 10:04:11,081][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 10:04:11,082][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-21 10:04:11,122][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-21 10:04:11,289][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-21 10:04:11,667][__main__][INFO] - Instantiating callbacks...
[2023-04-21 10:04:11,668][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 10:04:11,670][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-21 10:04:11,671][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 10:04:11,672][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 10:04:11,672][__main__][INFO] - Instantiating loggers...
[2023-04-21 10:04:11,673][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-21 10:04:11,673][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-21 10:04:11,822][__main__][INFO] - Starting training!
[2023-04-21 10:04:12,358][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 244, in setup
    self.data_train = NoisyMultiLabel(image_names=data['train']['images'][split_idx['train']],
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 85, in __init__
    net = ImageClassifier(pretrained=True, num_classes=num_classes)
TypeError: __init__() got an unexpected keyword argument 'pretrained'
[2023-04-21 10:04:12,360][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-21_10-04-11
[2023-04-21 10:05:24,299][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 10:05:24,303][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 10:05:24,303][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-21 10:05:24,346][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-21 10:05:24,515][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-21 10:05:24,920][__main__][INFO] - Instantiating callbacks...
[2023-04-21 10:05:24,921][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 10:05:24,924][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-21 10:05:24,925][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 10:05:24,925][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 10:05:24,926][__main__][INFO] - Instantiating loggers...
[2023-04-21 10:05:24,926][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-21 10:05:24,926][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-21 10:05:25,070][__main__][INFO] - Starting training!
[2023-04-21 10:05:26,035][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 244, in setup
    self.data_train = NoisyMultiLabel(image_names=data['train']['images'][split_idx['train']],
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 96, in __init__
    images = self.get_all_images()
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 103, in get_all_images
    image = self._load_image(image_path)
AttributeError: 'NoisyMultiLabel' object has no attribute '_load_image'
[2023-04-21 10:05:26,036][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-04-21_10-05-24
[2023-04-21 10:10:36,085][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 10:10:36,089][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 10:10:36,089][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-21 10:10:36,132][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-21 10:10:36,300][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-21 10:10:36,694][__main__][INFO] - Instantiating callbacks...
[2023-04-21 10:10:36,695][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 10:10:36,699][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-21 10:10:36,701][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 10:10:36,701][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 10:10:36,702][__main__][INFO] - Instantiating loggers...
[2023-04-21 10:10:36,703][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-21 10:10:36,703][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-21 10:10:36,854][__main__][INFO] - Starting training!
[2023-04-21 10:57:53,279][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-04-21 10:57:53,283][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-04-21 10:57:53,283][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-04-21 10:57:53,347][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-04-21 10:57:53,566][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-04-21 10:57:54,095][__main__][INFO] - Instantiating callbacks...
[2023-04-21 10:57:54,096][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-04-21 10:57:54,098][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-04-21 10:57:54,099][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-04-21 10:57:54,100][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-04-21 10:57:54,100][__main__][INFO] - Instantiating loggers...
[2023-04-21 10:57:54,100][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-04-21 10:57:54,101][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-04-21 10:57:54,233][__main__][INFO] - Starting training!
[2023-05-01 17:58:39,857][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 17:58:39,861][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 17:58:39,861][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 17:58:39,901][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.noisy_ml_datamodule.NoisyMLDataModule>
[2023-05-01 17:58:40,061][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-01 17:58:40,388][__main__][INFO] - Instantiating callbacks...
[2023-05-01 17:58:40,388][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 17:58:40,390][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-01 17:58:40,391][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 17:58:40,391][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 17:58:40,392][__main__][INFO] - Instantiating loggers...
[2023-05-01 17:58:40,392][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-01 17:58:40,392][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-01 17:58:40,525][__main__][INFO] - Starting training!
[2023-05-01 17:58:40,635][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/noisy_ml_datamodule.py", line 225, in setup
    data[phase]['labels'] = np.load(os.path.join(self.anno_dir, 'formatted_{}_labels.npy'.format(phase)))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/numpy/lib/npyio.py", line 417, in load
    fid = stack.enter_context(open(os_fspath(file), "rb"))
FileNotFoundError: [Errno 2] No such file or directory: '/home/dan/LabelNoise/data/MultiLabel/coco/annotations/mini2017/formatted_train_labels.npy'
[2023-05-01 17:58:40,642][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-01_17-58-39
[2023-05-01 17:59:22,485][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 17:59:22,489][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 17:59:22,489][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 17:59:22,536][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.NoisyMLDataModule>
[2023-05-01 17:59:22,703][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 981, in _find_and_load_unlocked
ModuleNotFoundError: No module named 'src.MultiLabel.data.partial_labels_datamodule.NoisyMLDataModule'; 'src.MultiLabel.data.partial_labels_datamodule' is not a package

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.data.partial_labels_datamodule.NoisyMLDataModule':
ModuleNotFoundError("No module named 'src.MultiLabel.data.partial_labels_datamodule.NoisyMLDataModule'; 'src.MultiLabel.data.partial_labels_datamodule' is not a package")
Are you sure that 'NoisyMLDataModule' is importable from module 'src.MultiLabel.data.partial_labels_datamodule'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 54, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.data.partial_labels_datamodule.NoisyMLDataModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: data
[2023-05-01 17:59:22,707][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-01_17-59-22
[2023-05-01 17:59:58,456][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 17:59:58,460][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 17:59:58,460][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 17:59:58,498][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-01 17:59:58,651][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'noise_mode'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 54, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule':
TypeError("__init__() got an unexpected keyword argument 'noise_mode'")
full_key: data
[2023-05-01 17:59:58,652][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-01_17-59-58
[2023-05-01 18:00:17,166][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 18:00:17,170][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 18:00:17,170][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 18:00:17,208][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-01 18:00:17,361][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
TypeError: __init__() got an unexpected keyword argument 'num_classes'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 54, in train
    datamodule: LightningDataModule = hydra.utils.instantiate(cfg.data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule':
TypeError("__init__() got an unexpected keyword argument 'num_classes'")
full_key: data
[2023-05-01 18:00:17,362][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-01_18-00-17
[2023-05-01 18:00:48,056][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 18:00:48,060][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 18:00:48,060][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 18:01:32,731][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 18:01:32,735][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 18:01:32,735][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 18:01:32,774][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-01 18:01:32,928][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-01 18:01:33,268][__main__][INFO] - Instantiating callbacks...
[2023-05-01 18:01:33,268][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 18:01:33,270][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-01 18:01:33,271][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 18:01:33,271][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 18:01:33,272][__main__][INFO] - Instantiating loggers...
[2023-05-01 18:01:33,272][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-01 18:01:33,272][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-01 18:01:33,405][__main__][INFO] - Starting training!
[2023-05-01 18:01:58,295][__main__][INFO] - Starting testing!
[2023-05-01 18:01:58,295][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-01 18:02:00,246][__main__][INFO] - Best ckpt path: None
[2023-05-01 18:02:00,251][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-01_18-01-32
[2023-05-01 18:02:00,252][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-01 18:03:50,648][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 18:03:50,652][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 18:03:50,652][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 18:03:50,690][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-01 18:03:50,843][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-01 18:03:51,171][__main__][INFO] - Instantiating callbacks...
[2023-05-01 18:03:51,172][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 18:03:51,174][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-01 18:03:51,174][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 18:03:51,175][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 18:03:51,175][__main__][INFO] - Instantiating loggers...
[2023-05-01 18:03:51,175][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-01 18:03:51,175][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-01 18:03:51,309][__main__][INFO] - Starting training!
[2023-05-01 18:03:52,829][__main__][INFO] - Starting testing!
[2023-05-01 18:03:52,829][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-01 18:03:53,657][__main__][INFO] - Best ckpt path: None
[2023-05-01 18:03:53,661][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-01_18-03-50
[2023-05-01 18:03:53,661][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-01 18:09:35,996][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-01 18:09:36,000][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-01 18:09:36,000][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-01 18:09:36,038][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-01 18:09:36,190][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-01 18:09:36,517][__main__][INFO] - Instantiating callbacks...
[2023-05-01 18:09:36,517][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-01 18:09:36,519][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-01 18:09:36,520][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-01 18:09:36,520][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-01 18:09:36,521][__main__][INFO] - Instantiating loggers...
[2023-05-01 18:09:36,521][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-01 18:09:36,521][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-01 18:09:36,653][__main__][INFO] - Starting training!
[2023-05-01 18:09:37,773][__main__][INFO] - Starting testing!
[2023-05-01 18:09:37,774][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-01 18:09:38,795][__main__][INFO] - Best ckpt path: None
[2023-05-01 18:09:38,799][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-01_18-09-35
[2023-05-01 18:09:38,800][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 09:57:04,834][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 09:57:04,838][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 09:57:04,838][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 09:57:04,876][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 09:57:05,033][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 09:57:05,587][__main__][INFO] - Instantiating callbacks...
[2023-05-16 09:57:05,587][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 09:57:05,589][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 09:57:05,590][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 09:57:05,590][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 09:57:05,591][__main__][INFO] - Instantiating loggers...
[2023-05-16 09:57:05,591][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 09:57:05,591][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 09:57:05,808][__main__][INFO] - Starting training!
[2023-05-16 09:57:37,349][__main__][INFO] - Starting testing!
[2023-05-16 09:57:37,349][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 09:57:38,995][__main__][INFO] - Best ckpt path: None
[2023-05-16 09:57:38,997][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_09-57-04
[2023-05-16 09:57:38,997][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 09:59:27,799][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 09:59:27,803][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 09:59:27,803][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 09:59:27,843][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 09:59:27,997][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 09:59:28,339][__main__][INFO] - Instantiating callbacks...
[2023-05-16 09:59:28,339][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 09:59:28,341][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 09:59:28,343][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 09:59:28,343][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 09:59:28,344][__main__][INFO] - Instantiating loggers...
[2023-05-16 09:59:28,344][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 09:59:28,344][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 09:59:28,560][__main__][INFO] - Starting training!
[2023-05-16 10:02:20,064][__main__][INFO] - Starting testing!
[2023-05-16 10:02:20,065][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 10:02:22,404][__main__][INFO] - Best ckpt path: None
[2023-05-16 10:02:22,407][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_09-59-27
[2023-05-16 10:02:22,408][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 10:02:32,233][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 10:02:32,237][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 10:02:32,237][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 10:02:32,275][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 10:02:32,432][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 10:02:32,765][__main__][INFO] - Instantiating callbacks...
[2023-05-16 10:02:32,765][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 10:02:32,767][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 10:02:32,768][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 10:02:32,769][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 10:02:32,769][__main__][INFO] - Instantiating loggers...
[2023-05-16 10:02:32,769][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 10:02:32,769][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 10:02:32,985][__main__][INFO] - Starting training!
[2023-05-16 10:04:27,442][__main__][INFO] - Starting testing!
[2023-05-16 10:04:27,443][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 10:04:28,802][__main__][INFO] - Best ckpt path: None
[2023-05-16 10:04:28,804][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_10-02-32
[2023-05-16 10:04:28,804][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 10:05:43,882][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 10:05:43,886][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 10:05:43,886][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 10:05:43,927][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 10:05:44,080][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 10:05:44,413][__main__][INFO] - Instantiating callbacks...
[2023-05-16 10:05:44,414][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 10:05:44,416][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 10:05:44,417][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 10:05:44,417][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 10:05:44,418][__main__][INFO] - Instantiating loggers...
[2023-05-16 10:05:44,418][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 10:05:44,418][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 10:05:44,636][__main__][INFO] - Starting training!
[2023-05-16 10:05:48,299][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2023-05-16 10:05:48,299][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
[2023-05-16 10:05:49,792][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 42, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 92, in launch
    return function(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 894, in _run
    self.__setup_profiler()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1024, in __setup_profiler
    self.profiler.setup(stage=self.state.fn, local_rank=local_rank, log_dir=self.log_dir)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1145, in log_dir
    dirpath = self.strategy.broadcast(dirpath)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 292, in broadcast
    torch.distributed.broadcast_object_list(obj, src, group=_group.WORLD)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 1436, in wrapper
    return func(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 2234, in broadcast_object_list
    tensor_list, size_list = zip(*[_object_to_tensor(obj, current_device) for obj in object_list])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 2234, in <listcomp>
    tensor_list, size_list = zip(*[_object_to_tensor(obj, current_device) for obj in object_list])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 1947, in _object_to_tensor
    byte_tensor = torch.ByteTensor(byte_storage).to(device)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[2023-05-16 10:05:49,795][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_10-05-43
[2023-05-16 10:07:58,642][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 10:07:58,646][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 10:07:58,646][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 10:07:58,687][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 10:07:58,843][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 10:07:59,178][__main__][INFO] - Instantiating callbacks...
[2023-05-16 10:07:59,179][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 10:07:59,181][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 10:07:59,182][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 10:07:59,182][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 10:07:59,183][__main__][INFO] - Instantiating loggers...
[2023-05-16 10:07:59,183][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 10:07:59,183][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 10:07:59,399][__main__][INFO] - Starting training!
[2023-05-16 10:08:02,880][torch.distributed.distributed_c10d][INFO] - Added key: store_based_barrier_key:1 to store for rank: 0
[2023-05-16 10:08:02,881][torch.distributed.distributed_c10d][INFO] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.
[2023-05-16 10:08:04,333][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 42, in _call_and_handle_interrupt
    return trainer.strategy.launcher.launch(trainer_fn, *args, trainer=trainer, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/launchers/subprocess_script.py", line 92, in launch
    return function(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 894, in _run
    self.__setup_profiler()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1024, in __setup_profiler
    self.profiler.setup(stage=self.state.fn, local_rank=local_rank, log_dir=self.log_dir)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1145, in log_dir
    dirpath = self.strategy.broadcast(dirpath)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/ddp.py", line 292, in broadcast
    torch.distributed.broadcast_object_list(obj, src, group=_group.WORLD)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 1436, in wrapper
    return func(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 2234, in broadcast_object_list
    tensor_list, size_list = zip(*[_object_to_tensor(obj, current_device) for obj in object_list])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 2234, in <listcomp>
    tensor_list, size_list = zip(*[_object_to_tensor(obj, current_device) for obj in object_list])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 1947, in _object_to_tensor
    byte_tensor = torch.ByteTensor(byte_storage).to(device)
RuntimeError: CUDA error: out of memory
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[2023-05-16 10:08:04,335][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_10-07-58
[2023-05-16 10:08:22,194][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 10:08:22,198][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 10:08:22,198][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 10:08:22,238][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 10:08:22,391][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 10:08:22,723][__main__][INFO] - Instantiating callbacks...
[2023-05-16 10:08:22,724][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 10:08:22,726][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 10:08:22,727][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 10:08:22,727][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 10:08:22,728][__main__][INFO] - Instantiating loggers...
[2023-05-16 10:08:22,728][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 10:08:22,728][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 10:08:22,943][__main__][INFO] - Starting training!
[2023-05-16 10:09:21,576][__main__][INFO] - Starting testing!
[2023-05-16 10:09:21,577][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 10:09:23,032][__main__][INFO] - Best ckpt path: None
[2023-05-16 10:09:23,035][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_10-08-22
[2023-05-16 10:09:23,036][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 10:11:44,963][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 10:11:44,969][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 10:11:44,970][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 10:11:45,040][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 10:11:45,432][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 10:11:45,988][__main__][INFO] - Instantiating callbacks...
[2023-05-16 10:11:45,988][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 10:11:45,990][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 10:11:45,991][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 10:11:45,992][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 10:11:45,992][__main__][INFO] - Instantiating loggers...
[2023-05-16 10:11:45,993][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 10:11:45,993][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 10:11:46,212][__main__][INFO] - Starting training!
[2023-05-16 10:20:35,359][__main__][INFO] - Starting testing!
[2023-05-16 10:20:38,228][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-05-16_10-11-44/checkpoints/epoch_000.ckpt
[2023-05-16 10:20:38,229][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_10-11-44
[2023-05-16 10:20:38,229][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 11:41:32,914][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 11:41:32,918][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 11:41:32,918][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 11:41:32,973][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 11:41:33,130][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 11:41:36,277][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 60, in __init__
    self.dtype = clip_model.dtype
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1674, in __setattr__
    super().__setattr__(name, value)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/lightning_fabric/utilities/device_dtype_mixin.py", line 37, in dtype
    raise RuntimeError("Cannot set the dtype explicitly. Please use module.to(new_dtype).")
RuntimeError: Cannot set the dtype explicitly. Please use module.to(new_dtype).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.models.CLIP_module.CLIP':
RuntimeError('Cannot set the dtype explicitly. Please use module.to(new_dtype).')
full_key: model
[2023-05-16 11:41:36,279][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_11-41-32
[2023-05-16 11:42:46,776][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 11:42:46,780][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 11:42:46,780][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 11:42:46,826][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 11:42:46,982][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 11:42:49,755][__main__][INFO] - Instantiating callbacks...
[2023-05-16 11:42:49,755][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 11:42:49,757][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 11:42:49,758][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 11:42:49,759][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 11:42:49,759][__main__][INFO] - Instantiating loggers...
[2023-05-16 11:42:49,759][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 11:42:49,760][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 11:42:49,890][__main__][INFO] - Starting training!
[2023-05-16 11:42:52,217][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 183, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 156, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 118, in forward
    image_features = self.model.encode_image(image)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 341, in encode_image
    return self.visual(image.type(self.dtype))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 152, in forward
    x = self.attnpool(x)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 71, in forward
    x = x + self.positional_embedding[:, None, :].to(x.dtype)  # (HW+1)NC
RuntimeError: The size of tensor a (197) must match the size of tensor b (50) at non-singleton dimension 0
[2023-05-16 11:42:52,220][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_11-42-46
[2023-05-16 11:55:34,296][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 11:55:34,300][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 11:55:34,300][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 11:55:34,363][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 11:55:34,592][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 11:55:37,239][__main__][INFO] - Instantiating callbacks...
[2023-05-16 11:55:37,239][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 11:55:37,241][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 11:55:37,242][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 11:55:37,242][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 11:55:37,243][__main__][INFO] - Instantiating loggers...
[2023-05-16 11:55:37,243][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 11:55:37,243][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 11:55:37,370][__main__][INFO] - Starting training!
[2023-05-16 11:55:38,862][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 183, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 156, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 120, in forward
    label_features = self.clip_model.encode_text(self.prompts)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'CLIP' object has no attribute 'clip_model'
[2023-05-16 11:55:38,865][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_11-55-34
[2023-05-16 13:17:58,069][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:17:58,073][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:17:58,073][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:17:58,114][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:17:58,347][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:18:01,056][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 60, in __init__
    self.dtype = clip_model.dtype
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1674, in __setattr__
    super().__setattr__(name, value)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/lightning_fabric/utilities/device_dtype_mixin.py", line 37, in dtype
    raise RuntimeError("Cannot set the dtype explicitly. Please use module.to(new_dtype).")
RuntimeError: Cannot set the dtype explicitly. Please use module.to(new_dtype).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.models.CLIP_module.CLIP':
RuntimeError('Cannot set the dtype explicitly. Please use module.to(new_dtype).')
full_key: model
[2023-05-16 13:18:01,057][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-17-58
[2023-05-16 13:22:10,543][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:22:10,547][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:22:10,548][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:22:10,587][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:22:10,820][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:22:13,527][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 92, in _call_target
    return _target_(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 60, in __init__
    self.dtype = torch.float32
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1674, in __setattr__
    super().__setattr__(name, value)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/lightning_fabric/utilities/device_dtype_mixin.py", line 37, in dtype
    raise RuntimeError("Cannot set the dtype explicitly. Please use module.to(new_dtype).")
RuntimeError: Cannot set the dtype explicitly. Please use module.to(new_dtype).

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 347, in instantiate_node
    return _call_target(_target_, partial, args, kwargs, full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 97, in _call_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error in call to target 'src.MultiLabel.models.CLIP_module.CLIP':
RuntimeError('Cannot set the dtype explicitly. Please use module.to(new_dtype).')
full_key: model
[2023-05-16 13:22:13,528][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-22-10
[2023-05-16 13:23:17,399][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:23:17,403][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:23:17,403][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:23:17,443][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:23:17,672][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:23:20,350][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:23:20,351][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:23:20,353][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:23:20,354][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:23:20,354][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:23:20,355][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:23:20,355][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:23:20,355][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:23:20,490][__main__][INFO] - Starting training!
[2023-05-16 13:23:22,035][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 184, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 157, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 121, in forward
    label_features = self.clip_model.encode_text(self.prompts)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'CLIP' object has no attribute 'clip_model'
[2023-05-16 13:23:22,038][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-23-17
[2023-05-16 13:25:06,552][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:25:06,556][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:25:06,556][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:25:06,596][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:25:06,824][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:25:09,502][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:25:09,502][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:25:09,504][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:25:09,505][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:25:09,506][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:25:09,506][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:25:09,506][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:25:09,506][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:25:09,637][__main__][INFO] - Starting training!
[2023-05-16 13:25:11,333][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 184, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 157, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 121, in forward
    label_features = self.model.encode_text(self.prompts)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 344, in encode_text
    x = self.token_embedding(text).type(self.dtype)  # [batch_size, n_ctx, d_model]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
[2023-05-16 13:25:11,335][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-25-06
[2023-05-16 13:25:55,156][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:25:55,159][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:25:55,160][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:25:55,205][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:25:55,436][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:25:58,160][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:25:58,160][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:25:58,162][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:25:58,163][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:25:58,164][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:25:58,164][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:25:58,164][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:25:58,164][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:25:58,294][__main__][INFO] - Starting training!
[2023-05-16 13:25:59,644][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 184, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 157, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 119, in forward
    image_features = self.model.encode_image(image.type(self.model.dtype))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 341, in encode_image
    return self.visual(image.type(self.dtype))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 147, in forward
    x = stem(x)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 140, in stem
    x = self.relu1(self.bn1(self.conv1(x)))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 463, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/conv.py", line 459, in _conv_forward
    return F.conv2d(input, weight, bias, self.stride,
RuntimeError: "slow_conv2d_cpu" not implemented for 'Half'
[2023-05-16 13:25:59,647][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-25-55
[2023-05-16 13:28:39,618][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:28:39,621][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:28:39,622][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:28:39,662][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:28:39,899][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:28:42,642][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:28:42,642][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:28:42,644][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:28:42,645][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:28:42,646][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:28:42,646][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:28:42,647][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:28:42,647][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:28:42,780][__main__][INFO] - Starting training!
[2023-05-16 13:28:44,380][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 184, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 157, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 121, in forward
    label_features = self.model.encode_text(self.prompts)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 344, in encode_text
    x = self.token_embedding(text).type(self.dtype)  # [batch_size, n_ctx, d_model]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
[2023-05-16 13:28:44,383][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-28-39
[2023-05-16 13:33:14,503][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:33:14,506][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:33:14,507][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:33:14,545][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:33:14,771][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:33:17,449][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:33:17,449][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:33:17,451][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:33:17,452][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:33:17,452][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:33:17,453][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:33:17,453][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:33:17,453][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:33:17,581][__main__][INFO] - Starting training!
[2023-05-16 13:33:19,181][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 185, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 158, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 122, in forward
    label_features = self.model.encode_text(self.prompts)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 344, in encode_text
    x = self.token_embedding(text).type(self.dtype)  # [batch_size, n_ctx, d_model]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
[2023-05-16 13:33:19,183][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-33-14
[2023-05-16 13:35:58,996][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:35:59,000][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:35:59,000][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:35:59,039][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:35:59,268][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:36:02,006][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:36:02,006][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:36:02,010][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:36:02,011][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:36:02,012][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:36:02,012][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:36:02,012][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:36:02,012][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:36:02,138][__main__][INFO] - Starting training!
[2023-05-16 13:36:03,698][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 185, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 158, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 122, in forward
    label_features = self.model.encode_text(self.prompts)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 344, in encode_text
    x = self.token_embedding(text).type(self.dtype)  # [batch_size, n_ctx, d_model]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
[2023-05-16 13:36:03,701][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-35-58
[2023-05-16 13:37:04,477][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:37:04,481][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:37:04,481][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:37:04,520][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:37:04,750][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:37:07,453][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:37:07,453][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:37:07,455][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:37:07,456][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:37:07,456][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:37:07,457][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:37:07,457][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:37:07,457][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:37:07,590][__main__][INFO] - Starting training!
[2023-05-16 13:37:09,247][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 187, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 160, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 123, in forward
    print(self.model.device)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'CLIP' object has no attribute 'device'
[2023-05-16 13:37:09,249][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-37-04
[2023-05-16 13:38:00,273][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:38:00,277][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:38:00,277][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:38:00,315][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:38:00,543][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:38:03,280][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:38:03,281][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:38:03,283][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:38:03,284][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:38:03,284][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:38:03,285][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:38:03,285][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:38:03,285][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:38:03,411][__main__][INFO] - Starting training!
[2023-05-16 13:38:04,987][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 187, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 160, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 124, in forward
    label_features = self.model.encode_text(self.prompts)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/clip/model.py", line 344, in encode_text
    x = self.token_embedding(text).type(self.dtype)  # [batch_size, n_ctx, d_model]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
RuntimeError: Expected all tensors to be on the same device, but found at least two devices, cuda:0 and cpu! (when checking argument for argument index in method wrapper_CUDA__index_select)
[2023-05-16 13:38:04,990][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-38-00
[2023-05-16 13:40:00,299][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:40:00,303][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:40:00,303][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:40:00,342][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:40:00,569][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:40:03,295][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:40:03,295][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:40:03,298][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:40:03,299][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:40:03,299][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:40:03,300][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:40:03,300][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:40:03,300][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:40:03,427][__main__][INFO] - Starting training!
[2023-05-16 13:40:05,154][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 187, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 160, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 130, in forward
    features = image_features + label_features
RuntimeError: The size of tensor a (32) must match the size of tensor b (80) at non-singleton dimension 0
[2023-05-16 13:40:05,156][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-40-00
[2023-05-16 13:46:02,707][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:46:02,710][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:46:02,711][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:46:02,751][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:46:02,981][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:46:05,737][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:46:05,737][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:46:05,740][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:46:05,741][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:46:05,741][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:46:05,742][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:46:05,742][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:46:05,742][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:46:05,872][__main__][INFO] - Starting training!
[2023-05-16 13:46:07,580][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 189, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 162, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 132, in forward
    features = image_features + label_features
RuntimeError: The size of tensor a (32) must match the size of tensor b (80) at non-singleton dimension 0
[2023-05-16 13:46:07,582][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-46-02
[2023-05-16 13:49:28,655][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 13:49:28,659][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 13:49:28,659][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 13:49:28,699][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 13:49:28,925][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 13:49:31,654][__main__][INFO] - Instantiating callbacks...
[2023-05-16 13:49:31,654][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 13:49:31,656][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 13:49:31,657][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 13:49:31,658][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 13:49:31,658][__main__][INFO] - Instantiating loggers...
[2023-05-16 13:49:31,658][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 13:49:31,658][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 13:49:31,790][__main__][INFO] - Starting training!
[2023-05-16 13:49:33,526][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 188, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 161, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 131, in forward
    features = image_features + label_features
RuntimeError: The size of tensor a (32) must match the size of tensor b (80) at non-singleton dimension 0
[2023-05-16 13:49:33,529][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_13-49-28
[2023-05-16 14:07:25,115][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:07:25,118][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:07:25,119][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:07:25,157][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:07:25,385][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:07:28,125][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:07:28,126][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:07:28,128][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:07:28,129][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:07:28,129][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:07:28,130][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:07:28,130][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:07:28,130][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:07:28,260][__main__][INFO] - Starting training!
[2023-05-16 14:07:29,928][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 186, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 159, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 130, in forward
    output = self.classifier(image_features)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 must have the same dtype
[2023-05-16 14:07:29,931][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-07-25
[2023-05-16 14:10:03,007][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:10:03,011][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:10:03,011][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:10:03,050][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:10:03,278][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:10:06,019][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:10:06,019][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:10:06,021][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:10:06,022][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:10:06,022][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:10:06,023][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:10:06,023][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:10:06,023][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:10:06,151][__main__][INFO] - Starting training!
[2023-05-16 14:10:20,953][__main__][INFO] - Starting testing!
[2023-05-16 14:10:20,954][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 14:10:22,787][__main__][INFO] - Best ckpt path: None
[2023-05-16 14:10:22,790][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-10-02
[2023-05-16 14:10:22,791][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 14:10:57,832][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:10:57,836][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:10:57,836][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:10:57,876][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:10:58,108][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:11:00,831][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:11:00,831][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:11:00,833][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:11:00,834][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:11:00,834][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:11:00,835][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:11:00,835][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:11:00,835][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:11:00,966][__main__][INFO] - Starting training!
[2023-05-16 14:11:02,630][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 187, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 160, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 130, in forward
    print(self.image_features.dtype)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1614, in __getattr__
    raise AttributeError("'{}' object has no attribute '{}'".format(
AttributeError: 'CLIP' object has no attribute 'image_features'
[2023-05-16 14:11:02,633][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-10-57
[2023-05-16 14:11:15,887][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:11:15,891][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:11:15,891][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:11:15,930][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:11:16,159][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:11:18,887][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:11:18,888][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:11:18,892][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:11:18,892][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:11:18,893][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:11:18,893][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:11:18,894][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:11:18,894][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:11:19,021][__main__][INFO] - Starting training!
[2023-05-16 14:11:24,206][__main__][INFO] - Starting testing!
[2023-05-16 14:11:24,206][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 14:11:25,998][__main__][INFO] - Best ckpt path: None
[2023-05-16 14:11:26,000][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-11-15
[2023-05-16 14:11:26,001][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 14:13:03,558][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:13:03,562][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:13:03,562][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:13:03,600][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:13:03,828][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:13:06,580][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:13:06,580][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:13:06,582][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:13:06,583][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:13:06,584][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:13:06,584][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:13:06,584][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:13:06,584][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:13:06,711][__main__][INFO] - Starting training!
[2023-05-16 14:13:10,059][__main__][INFO] - Starting testing!
[2023-05-16 14:13:10,060][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 14:13:12,023][__main__][INFO] - Best ckpt path: None
[2023-05-16 14:13:12,026][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-13-03
[2023-05-16 14:13:12,027][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 14:15:27,296][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:15:27,300][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:15:27,300][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:15:27,339][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:15:27,569][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:15:30,297][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:15:30,298][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:15:30,300][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:15:30,301][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:15:30,301][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:15:30,302][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:15:30,302][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:15:30,302][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:15:30,433][__main__][INFO] - Starting training!
[2023-05-16 14:15:33,812][__main__][INFO] - Starting testing!
[2023-05-16 14:15:33,812][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 14:15:35,784][__main__][INFO] - Best ckpt path: None
[2023-05-16 14:15:35,787][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-15-27
[2023-05-16 14:15:35,788][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 14:18:20,393][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:18:20,397][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:18:20,397][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:18:20,437][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:18:20,665][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:18:23,263][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:18:23,263][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:18:23,265][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:18:23,266][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:18:23,267][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:18:23,267][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:18:23,267][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:18:23,267][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:18:23,395][__main__][INFO] - Starting training!
[2023-05-16 14:18:29,151][__main__][INFO] - Starting testing!
[2023-05-16 14:18:29,151][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 14:18:30,818][__main__][INFO] - Best ckpt path: None
[2023-05-16 14:18:30,820][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-18-20
[2023-05-16 14:18:30,820][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 14:18:41,719][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 14:18:41,723][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 14:18:41,723][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 14:18:41,763][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 14:18:41,996][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 14:18:44,559][__main__][INFO] - Instantiating callbacks...
[2023-05-16 14:18:44,560][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 14:18:44,562][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 14:18:44,563][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 14:18:44,563][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 14:18:44,563][__main__][INFO] - Instantiating loggers...
[2023-05-16 14:18:44,564][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 14:18:44,564][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 14:18:44,691][__main__][INFO] - Starting training!
[2023-05-16 15:23:00,018][__main__][INFO] - Starting testing!
[2023-05-16 15:23:40,675][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-18-41/checkpoints/epoch_014.ckpt
[2023-05-16 15:23:40,676][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_14-18-41
[2023-05-16 15:23:40,676][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 15:24:22,406][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:24:22,410][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:24:22,410][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:24:22,448][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:24:22,676][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 15:24:23,005][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:24:23,005][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:24:23,007][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:24:23,008][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:24:23,008][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:24:23,009][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:24:23,009][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:24:23,009][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:24:23,151][__main__][INFO] - Starting training!
[2023-05-16 15:37:17,009][__main__][INFO] - Starting testing!
[2023-05-16 15:37:19,144][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-05-16_15-24-22/checkpoints/epoch_004.ckpt
[2023-05-16 15:37:19,147][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_15-24-22
[2023-05-16 15:37:19,148][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 15:38:39,875][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:38:39,879][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:38:39,879][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:38:39,916][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:38:40,143][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:38:42,469][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:38:42,469][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:38:42,471][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:38:42,472][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:38:42,472][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:38:42,473][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:38:42,473][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:38:42,473][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:38:42,602][__main__][INFO] - Starting training!
[2023-05-16 15:38:44,446][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 184, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 162, in model_step
    loss = self.criterion(logits, labels)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/loss.py", line 619, in forward
    return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 3098, in binary_cross_entropy
    return torch._C._nn.binary_cross_entropy(input, target, weight, reduction_enum)
RuntimeError: Found dtype Double but expected Float
[2023-05-16 15:38:44,449][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_15-38-39
[2023-05-16 15:43:49,943][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:43:49,946][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:43:49,947][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:43:49,983][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:43:50,212][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:43:52,506][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:43:52,507][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:43:52,509][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:43:52,509][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:43:52,510][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:43:52,510][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:43:52,510][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:43:52,511][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:43:52,636][__main__][INFO] - Starting training!
[2023-05-16 15:43:54,449][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 183, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 161, in model_step
    loss = self.criterion(logits.float(), labels)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/loss.py", line 619, in forward
    return F.binary_cross_entropy(input, target, weight=self.weight, reduction=self.reduction)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/functional.py", line 3098, in binary_cross_entropy
    return torch._C._nn.binary_cross_entropy(input, target, weight, reduction_enum)
RuntimeError: Found dtype Double but expected Float
[2023-05-16 15:43:54,452][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_15-43-49
[2023-05-16 15:44:10,606][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:44:10,610][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:44:10,610][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:44:10,647][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:44:10,880][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:44:13,249][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:44:13,249][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:44:13,251][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:44:13,252][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:44:13,252][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:44:13,253][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:44:13,253][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:44:13,253][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:44:13,382][__main__][INFO] - Starting training!
[2023-05-16 15:44:14,974][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 186, in validation_step
    self.val_loss(loss)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 400, in wrapped_func
    raise err
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/aggregation.py", line 396, in update
    value = self._cast_and_nan_check_input(value)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/aggregation.py", line 73, in _cast_and_nan_check_input
    if nans.any():
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 68, in _call_and_handle_interrupt
    trainer._teardown()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 958, in _teardown
    self.strategy.teardown()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 475, in teardown
    self.lightning_module.cpu()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/lightning_fabric/utilities/device_dtype_mixin.py", line 78, in cpu
    return super().cpu()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 954, in cpu
    return self._apply(lambda t: t.cpu())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 954, in <lambda>
    return self._apply(lambda t: t.cpu())
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[2023-05-16 15:44:14,978][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_15-44-10
[2023-05-16 15:44:52,553][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:44:52,557][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:44:52,557][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:44:52,596][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:44:52,823][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:44:55,118][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:44:55,119][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:44:55,121][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:44:55,121][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:44:55,122][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:44:55,122][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:44:55,123][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:44:55,123][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:44:55,249][__main__][INFO] - Starting training!
[2023-05-16 15:49:13,621][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:49:13,628][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:49:13,628][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:49:13,728][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:49:14,308][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:49:18,609][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:49:18,609][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:49:18,613][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:49:18,615][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:49:18,616][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:49:18,617][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:49:18,617][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:49:18,617][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:49:18,826][__main__][INFO] - Starting training!
[2023-05-16 15:49:25,338][__main__][INFO] - Starting testing!
[2023-05-16 15:49:25,338][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 15:49:27,849][__main__][INFO] - Best ckpt path: None
[2023-05-16 15:49:27,852][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_15-49-13
[2023-05-16 15:49:27,852][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 15:49:45,994][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:49:46,001][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:49:46,001][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:49:46,076][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:49:46,423][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:49:49,784][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:49:49,784][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:49:49,787][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:49:49,788][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:49:49,789][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:49:49,789][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:49:49,790][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:49:49,790][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:49:49,966][__main__][INFO] - Starting training!
[2023-05-16 15:49:52,223][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 187, in validation_step
    self.val_loss(loss)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 236, in forward
    self._forward_cache = self._forward_reduce_state_update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 302, in _forward_reduce_state_update
    self.update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 400, in wrapped_func
    raise err
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/metric.py", line 390, in wrapped_func
    update(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/aggregation.py", line 396, in update
    value = self._cast_and_nan_check_input(value)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torchmetrics/aggregation.py", line 73, in _cast_and_nan_check_input
    if nans.any():
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 68, in _call_and_handle_interrupt
    trainer._teardown()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 958, in _teardown
    self.strategy.teardown()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 475, in teardown
    self.lightning_module.cpu()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/lightning_fabric/utilities/device_dtype_mixin.py", line 78, in cpu
    return super().cpu()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 954, in cpu
    return self._apply(lambda t: t.cpu())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/nn/modules/module.py", line 954, in <lambda>
    return self._apply(lambda t: t.cpu())
RuntimeError: CUDA error: device-side assert triggered
CUDA kernel errors might be asynchronously reported at some other API call, so the stacktrace below might be incorrect.
For debugging consider passing CUDA_LAUNCH_BLOCKING=1.
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

[2023-05-16 15:49:52,230][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_15-49-45
[2023-05-16 15:50:11,690][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:50:11,694][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:50:11,695][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:50:11,746][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:50:12,058][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:50:14,447][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:50:14,447][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:50:14,450][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:50:14,450][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:50:14,451][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:50:14,452][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:50:14,452][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:50:14,452][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:50:14,580][__main__][INFO] - Starting training!
[2023-05-16 15:55:05,029][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 15:55:05,033][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 15:55:05,033][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 15:55:05,103][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 15:55:05,332][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 15:55:07,634][__main__][INFO] - Instantiating callbacks...
[2023-05-16 15:55:07,635][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 15:55:07,637][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 15:55:07,638][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 15:55:07,638][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 15:55:07,639][__main__][INFO] - Instantiating loggers...
[2023-05-16 15:55:07,639][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 15:55:07,639][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 15:55:07,767][__main__][INFO] - Starting training!
[2023-05-16 16:02:16,123][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 16:02:16,133][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 16:02:16,135][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 16:02:16,249][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 16:02:16,810][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 16:02:20,953][__main__][INFO] - Instantiating callbacks...
[2023-05-16 16:02:20,954][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 16:02:20,957][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 16:02:20,959][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 16:02:20,961][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 16:02:20,962][__main__][INFO] - Instantiating loggers...
[2023-05-16 16:02:20,963][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 16:02:20,964][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 16:02:21,191][__main__][INFO] - Starting training!
[2023-05-16 16:02:24,369][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 183, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 156, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 134, in forward
    output = 20 * F.conv1d(image_features, label_features[:, :, None])
RuntimeError: Given groups=1, weight of size [80, 1024, 1], expected input[1, 32, 1024] to have 1024 channels, but got 32 channels instead
[2023-05-16 16:02:24,375][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_16-02-16
[2023-05-16 16:14:28,287][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 16:14:28,291][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 16:14:28,291][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 16:14:28,337][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 16:14:28,563][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 16:14:30,823][__main__][INFO] - Instantiating callbacks...
[2023-05-16 16:14:30,823][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 16:14:30,825][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 16:14:30,826][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 16:14:30,826][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 16:14:30,827][__main__][INFO] - Instantiating loggers...
[2023-05-16 16:14:30,827][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 16:14:30,827][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 16:14:30,958][__main__][INFO] - Starting training!
[2023-05-16 16:14:32,833][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 183, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 156, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 134, in forward
    output = 20 * F.conv1d(image_features, label_features[:, :, None])
RuntimeError: Given groups=1, weight of size [80, 1024, 1], expected input[1, 32, 1024] to have 1024 channels, but got 32 channels instead
[2023-05-16 16:14:32,835][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_16-14-28
[2023-05-16 16:20:13,588][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 16:20:13,591][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 16:20:13,592][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 16:20:13,631][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 16:20:13,860][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 16:20:16,125][__main__][INFO] - Instantiating callbacks...
[2023-05-16 16:20:16,126][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 16:20:16,128][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 16:20:16,129][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 16:20:16,129][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 16:20:16,130][__main__][INFO] - Instantiating loggers...
[2023-05-16 16:20:16,130][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 16:20:16,130][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 16:20:16,257][__main__][INFO] - Starting training!
[2023-05-16 16:20:18,041][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 184, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 157, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 134, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 16:20:18,044][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_16-20-13
[2023-05-16 16:23:47,456][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 16:23:47,460][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 16:23:47,460][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 16:23:47,500][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 16:23:47,726][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 16:23:50,019][__main__][INFO] - Instantiating callbacks...
[2023-05-16 16:23:50,019][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 16:23:50,022][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 16:23:50,022][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 16:23:50,023][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 16:23:50,023][__main__][INFO] - Instantiating loggers...
[2023-05-16 16:23:50,023][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 16:23:50,024][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 16:23:50,149][__main__][INFO] - Starting training!
[2023-05-16 16:23:51,934][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 185, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 158, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 135, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 16:23:51,937][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_16-23-47
[2023-05-16 16:40:21,033][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 16:40:21,037][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 16:40:21,037][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 16:40:21,083][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 16:40:21,317][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 16:40:23,582][__main__][INFO] - Instantiating callbacks...
[2023-05-16 16:40:23,582][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 16:40:23,584][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 16:40:23,585][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 16:40:23,585][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 16:40:23,586][__main__][INFO] - Instantiating loggers...
[2023-05-16 16:40:23,586][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 16:40:23,586][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 16:40:23,717][__main__][INFO] - Starting training!
[2023-05-16 16:40:25,611][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 186, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 159, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 136, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 16:40:25,613][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_16-40-20
[2023-05-16 16:49:40,971][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 16:49:40,975][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 16:49:40,975][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 16:49:41,012][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 16:49:41,236][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 16:49:43,498][__main__][INFO] - Instantiating callbacks...
[2023-05-16 16:49:43,498][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 16:49:43,500][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 16:49:43,501][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 16:49:43,502][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 16:49:43,502][__main__][INFO] - Instantiating loggers...
[2023-05-16 16:49:43,502][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 16:49:43,502][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 16:49:43,629][__main__][INFO] - Starting training!
[2023-05-16 16:49:45,411][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 186, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 159, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 136, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 16:49:45,414][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_16-49-40
[2023-05-16 16:58:55,749][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 16:58:55,753][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 16:58:55,753][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 16:58:55,792][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 16:58:56,015][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIP>
[2023-05-16 16:58:56,018][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.MultiLabel.models' has no attribute 'CLIP_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 2, in <module>
    from components.clip import clip
ModuleNotFoundError: No module named 'components'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.models.CLIP_module.CLIP':
ModuleNotFoundError("No module named 'components'")
Are you sure that 'CLIP_module' is importable from module 'src.MultiLabel.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.models.CLIP_module.CLIP', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 16:58:56,020][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_16-58-55
[2023-05-16 17:00:13,127][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:00:13,131][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:00:13,131][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:00:13,168][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:00:13,395][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:00:13,398][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.MultiLabel.models' has no attribute 'CLIP_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 2, in <module>
    from components.clip import clip
ModuleNotFoundError: No module named 'components'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.models.CLIP_module.CLIPModule':
ModuleNotFoundError("No module named 'components'")
Are you sure that 'CLIP_module' is importable from module 'src.MultiLabel.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.models.CLIP_module.CLIPModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:00:13,399][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-00-13
[2023-05-16 17:01:19,403][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:01:19,407][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:01:19,407][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:01:19,443][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:01:19,668][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModuleW>
[2023-05-16 17:01:19,670][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.MultiLabel.models' has no attribute 'CLIP_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 2, in <module>
    from components.clip import clip
ModuleNotFoundError: No module named 'components'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.models.CLIP_module.CLIPModuleW':
ModuleNotFoundError("No module named 'components'")
Are you sure that 'CLIP_module' is importable from module 'src.MultiLabel.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.models.CLIP_module.CLIPModuleW', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:01:19,671][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-01-19
[2023-05-16 17:01:36,206][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:01:36,210][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:01:36,210][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:01:36,246][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:01:36,471][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:01:36,473][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.MultiLabel.models' has no attribute 'CLIP_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 2, in <module>
    from components.clip import clip
ModuleNotFoundError: No module named 'components'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.models.CLIP_module.CLIPModule':
ModuleNotFoundError("No module named 'components'")
Are you sure that 'CLIP_module' is importable from module 'src.MultiLabel.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.models.CLIP_module.CLIPModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:01:36,474][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-01-36
[2023-05-16 17:01:45,629][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:01:45,632][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:01:45,633][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:01:45,671][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:01:45,897][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-16 17:01:46,450][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:01:46,450][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:01:46,452][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 17:01:46,453][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:01:46,453][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:01:46,454][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:01:46,454][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 17:01:46,454][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 17:01:46,596][__main__][INFO] - Starting training!
[2023-05-16 17:01:49,737][__main__][INFO] - Starting testing!
[2023-05-16 17:01:49,738][__main__][WARNING] - Best ckpt not found! Using current weights for testing...
[2023-05-16 17:01:50,824][__main__][INFO] - Best ckpt path: None
[2023-05-16 17:01:50,827][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-01-45
[2023-05-16 17:01:50,828][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-16 17:03:03,159][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:03:03,163][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:03:03,163][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:03:03,198][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:03:03,424][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:03:03,425][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.MultiLabel.models' has no attribute 'CLIP_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 2, in <module>
    from components.clip import clip
ModuleNotFoundError: No module named 'components'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.models.CLIP_module.CLIPModule':
ModuleNotFoundError("No module named 'components'")
Are you sure that 'CLIP_module' is importable from module 'src.MultiLabel.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.models.CLIP_module.CLIPModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:03:03,427][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-03-03
[2023-05-16 17:03:53,729][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:03:53,733][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:03:53,733][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:03:53,769][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:03:53,996][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:03:56,284][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:03:56,284][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:03:56,286][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 17:03:56,287][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:03:56,287][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:03:56,288][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:03:56,288][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 17:03:56,288][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 17:03:56,413][__main__][INFO] - Starting training!
[2023-05-16 17:03:58,249][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 186, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 159, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 136, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 17:03:58,251][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-03-53
[2023-05-16 17:08:08,881][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:08:08,885][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:08:08,885][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:08:08,921][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:08:09,146][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:08:09,149][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.MultiLabel.models' has no attribute 'CLIP_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 7, in <module>
    from components.clip import clip
ModuleNotFoundError: No module named 'components'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.models.CLIP_module.CLIPModule':
ModuleNotFoundError("No module named 'components'")
Are you sure that 'CLIP_module' is importable from module 'src.MultiLabel.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.models.CLIP_module.CLIPModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:08:09,150][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-08-08
[2023-05-16 17:08:59,538][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:08:59,542][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:08:59,542][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:08:59,581][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:08:59,808][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:09:02,094][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:09:02,094][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:09:02,096][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 17:09:02,097][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:09:02,097][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:09:02,098][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:09:02,098][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 17:09:02,098][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 17:09:02,224][__main__][INFO] - Starting training!
[2023-05-16 17:09:03,935][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 186, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 159, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 136, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 17:09:03,937][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-08-59
[2023-05-16 17:10:51,688][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:10:51,692][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:10:51,692][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:10:51,728][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:10:51,958][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:10:54,223][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:10:54,223][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:10:54,225][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 17:10:54,226][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:10:54,226][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:10:54,227][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:10:54,227][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 17:10:54,227][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 17:10:54,357][__main__][INFO] - Starting training!
[2023-05-16 17:10:56,130][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 187, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 160, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 137, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 17:10:56,132][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-10-51
[2023-05-16 17:21:57,681][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:21:57,685][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:21:57,685][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:21:57,723][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:21:57,949][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:21:57,952][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 644, in _locate
    obj = getattr(obj, part)
AttributeError: module 'src.MultiLabel.models' has no attribute 'CLIP_module'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 650, in _locate
    obj = import_module(mod)
  File "/home/dan/anaconda3/lib/python3.9/importlib/__init__.py", line 127, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
  File "<frozen importlib._bootstrap>", line 1030, in _gcd_import
  File "<frozen importlib._bootstrap>", line 1007, in _find_and_load
  File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked
  File "<frozen importlib._bootstrap>", line 680, in _load_unlocked
  File "<frozen importlib._bootstrap_external>", line 850, in exec_module
  File "<frozen importlib._bootstrap>", line 228, in _call_with_frames_removed
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 7, in <module>
    from clippy import clip
ModuleNotFoundError: No module named 'clippy'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 134, in _resolve_target
    target = _locate(target)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/utils.py", line 653, in _locate
    raise ImportError(
ImportError: Error loading 'src.MultiLabel.models.CLIP_module.CLIPModule':
ModuleNotFoundError("No module named 'clippy'")
Are you sure that 'CLIP_module' is importable from module 'src.MultiLabel.models'?

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 57, in train
    model: LightningModule = hydra.utils.instantiate(cfg.model)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 226, in instantiate
    return instantiate_node(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 333, in instantiate_node
    _target_ = _resolve_target(node.get(_Keys.TARGET), full_key)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/hydra/_internal/instantiate/_instantiate2.py", line 139, in _resolve_target
    raise InstantiationException(msg) from e
hydra.errors.InstantiationException: Error locating target 'src.MultiLabel.models.CLIP_module.CLIPModule', set env var HYDRA_FULL_ERROR=1 to see chained exception.
full_key: model
[2023-05-16 17:21:57,953][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-21-57
[2023-05-16 17:22:16,520][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:22:16,525][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:22:16,525][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:22:16,562][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:22:16,788][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:22:18,780][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:22:18,781][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:22:18,783][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 17:22:18,784][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:22:18,784][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:22:18,785][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:22:18,785][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 17:22:18,785][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 17:22:18,911][__main__][INFO] - Starting training!
[2023-05-16 17:22:20,661][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 187, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 160, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 137, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 17:22:20,664][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-22-16
[2023-05-16 17:26:16,595][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-16 17:26:16,599][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-16 17:26:16,599][src.utils.rich_utils][WARNING] - Field 'logger' not found in config. Skipping 'logger' config printing...
[2023-05-16 17:26:16,637][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-16 17:26:16,862][__main__][INFO] - Instantiating model <src.MultiLabel.models.CLIP_module.CLIPModule>
[2023-05-16 17:26:18,818][__main__][INFO] - Instantiating callbacks...
[2023-05-16 17:26:18,819][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-16 17:26:18,821][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-16 17:26:18,822][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-16 17:26:18,822][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-16 17:26:18,823][__main__][INFO] - Instantiating loggers...
[2023-05-16 17:26:18,823][src.utils.instantiatiators][WARNING] - No logger configs found! Skipping...
[2023-05-16 17:26:18,823][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-16 17:26:18,950][__main__][INFO] - Starting training!
[2023-05-16 17:26:20,663][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 115, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 375, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_kwargs.values())
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 288, in _call_strategy_hook
    output = fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/strategies/strategy.py", line 378, in validation_step
    return self.model.validation_step(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 188, in validation_step
    loss, preds = self.model_step(images, targets)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 161, in model_step
    logits = self.forward(images)
  File "/home/dan/LabelNoise/src/MultiLabel/models/CLIP_module.py", line 138, in forward
    image_features = image_features.permute(0, 2, 1)
RuntimeError: permute(sparse_coo): number of dimensions in the tensor input does not match the length of the desired ordering of dimensions i.e. input.dim() = 2 is not equal to len(dims) = 3
[2023-05-16 17:26:20,665][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-16_17-26-16
[2023-05-17 14:39:08,287][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-17 14:39:08,291][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-17 14:39:08,345][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-17 14:39:08,581][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-17 14:39:08,908][__main__][INFO] - Instantiating callbacks...
[2023-05-17 14:39:08,908][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-17 14:39:08,910][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-17 14:39:08,911][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-17 14:39:08,912][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-17 14:39:08,912][__main__][INFO] - Instantiating loggers...
[2023-05-17 14:39:08,912][src.utils.instantiatiators][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-17 14:39:17,065][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-17 14:39:17,229][__main__][INFO] - Logging hyperparameters!
[2023-05-17 14:39:17,238][__main__][INFO] - Starting training!
[2023-05-17 14:39:17,384][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/partial_labels_datamodule.py", line 241, in setup
    partial_labels=data['train']['partial_labels'][split_idx['train'], :],
TypeError: 'NoneType' object is not subscriptable
[2023-05-17 14:39:17,386][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-17_14-39-08
[2023-05-17 14:39:17,386][src.utils.utils][INFO] - Closing wandb!
[2023-05-17 14:40:05,065][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-17 14:40:05,069][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-17 14:40:05,112][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-17 14:40:05,343][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-17 14:40:05,668][__main__][INFO] - Instantiating callbacks...
[2023-05-17 14:40:05,668][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-17 14:40:05,670][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-17 14:40:05,671][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-17 14:40:05,672][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-17 14:40:05,672][__main__][INFO] - Instantiating loggers...
[2023-05-17 14:40:05,672][src.utils.instantiatiators][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-17 14:40:12,738][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-17 14:40:12,891][__main__][INFO] - Logging hyperparameters!
[2023-05-17 14:40:12,899][__main__][INFO] - Starting training!
[2023-05-17 14:40:13,420][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 935, in _run
    results = self._run_stage()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 976, in _run_stage
    self._run_sanity_check()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 1005, in _run_sanity_check
    val_loop.run()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/utilities.py", line 177, in _decorator
    return loop_run(self, *args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 108, in run
    batch, batch_idx, dataloader_idx = next(data_fetcher)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 136, in __next__
    self._fetch_next_batch(self.dataloader_iter)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/loops/fetchers.py", line 150, in _fetch_next_batch
    batch = next(iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 276, in __next__
    out = next(self._iterator)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/utilities/combined_loader.py", line 122, in __next__
    out = next(self.iterators[self._iterator_idx])
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 634, in __next__
    data = self._next_data()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1346, in _next_data
    return self._process_data(data)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 1372, in _process_data
    data.reraise()
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/_utils.py", line 644, in reraise
    raise exception
TypeError: Caught TypeError in DataLoader worker process 0.
Original Traceback (most recent call last):
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/worker.py", line 308, in _worker_loop
    data = fetcher.fetch(index)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in fetch
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/anaconda3/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 51, in <listcomp>
    data = [self.dataset[idx] for idx in possibly_batched_index]
  File "/home/dan/LabelNoise/src/MultiLabel/data/partial_labels_datamodule.py", line 97, in __getitem__
    return image, self.labels_pt[index, :], self.ground_truth_labels[index, :], index
TypeError: 'NoneType' object is not subscriptable

[2023-05-17 14:40:13,424][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-17_14-40-04
[2023-05-17 14:40:13,424][src.utils.utils][INFO] - Closing wandb!
[2023-05-17 14:40:57,153][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-17 14:40:57,158][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-17 14:40:57,201][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-17 14:40:57,427][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-17 14:40:57,777][__main__][INFO] - Instantiating callbacks...
[2023-05-17 14:40:57,778][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-17 14:40:57,780][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-17 14:40:57,780][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-17 14:40:57,781][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-17 14:40:57,781][__main__][INFO] - Instantiating loggers...
[2023-05-17 14:40:57,782][src.utils.instantiatiators][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-17 14:40:59,592][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-17_14-40-57
[2023-05-17 14:41:19,080][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-17 14:41:19,084][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-17 14:41:19,127][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-17 14:41:19,357][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-17 14:41:19,684][__main__][INFO] - Instantiating callbacks...
[2023-05-17 14:41:19,684][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-17 14:41:19,686][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-17 14:41:19,687][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-17 14:41:19,687][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-17 14:41:19,688][__main__][INFO] - Instantiating loggers...
[2023-05-17 14:41:19,688][src.utils.instantiatiators][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-17 14:41:26,453][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-17 14:41:26,601][__main__][INFO] - Logging hyperparameters!
[2023-05-17 14:41:26,607][__main__][INFO] - Starting training!
[2023-05-17 15:18:18,643][__main__][INFO] - Starting testing!
[2023-05-17 15:18:40,308][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-05-17_14-41-19/checkpoints/epoch_014.ckpt
[2023-05-17 15:18:40,310][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-17_14-41-19
[2023-05-17 15:18:40,310][src.utils.utils][INFO] - Closing wandb!
[2023-05-17 15:18:49,833][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
[2023-05-19 13:06:39,898][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-19 13:06:39,902][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-19 13:06:39,944][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-19 13:06:40,099][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-19 13:06:40,430][__main__][INFO] - Instantiating callbacks...
[2023-05-19 13:06:40,430][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-19 13:06:40,433][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-19 13:06:40,433][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-19 13:06:40,434][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-19 13:06:40,434][__main__][INFO] - Instantiating loggers...
[2023-05-19 13:06:40,434][src.utils.instantiatiators][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-19 13:06:47,496][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-19 13:06:47,646][__main__][INFO] - Logging hyperparameters!
[2023-05-19 13:06:47,652][__main__][INFO] - Starting training!
[2023-05-19 13:06:47,807][src.utils.utils][ERROR] - 
Traceback (most recent call last):
  File "/home/dan/LabelNoise/src/utils/utils.py", line 65, in wrap
    metric_dict, object_dict = task_func(cfg=cfg)
  File "/home/dan/LabelNoise/src/train.py", line 87, in train
    trainer.fit(model=model, datamodule=datamodule, ckpt_path=cfg.get("ckpt_path"))
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 520, in fit
    call._call_and_handle_interrupt(
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 44, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 559, in _fit_impl
    self._run(model, ckpt_path=ckpt_path)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/trainer.py", line 896, in _run
    call._call_setup_hook(self)  # allow user to setup lightning_module in accelerator environment
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 81, in _call_setup_hook
    _call_lightning_datamodule_hook(trainer, "setup", stage=fn)
  File "/home/dan/anaconda3/lib/python3.9/site-packages/pytorch_lightning/trainer/call.py", line 162, in _call_lightning_datamodule_hook
    return fn(*args, **kwargs)
  File "/home/dan/LabelNoise/src/MultiLabel/data/partial_labels_datamodule.py", line 260, in setup
    partial_labels['val'] = data['val']['partial_labels'][split_idx[phase], :]
IndexError: index 4954 is out of bounds for axis 0 with size 4952
[2023-05-19 13:06:47,808][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-19_13-06-39
[2023-05-19 13:06:47,808][src.utils.utils][INFO] - Closing wandb!
[2023-05-19 13:23:31,106][src.utils.utils][INFO] - Enforcing tags! <cfg.extras.enforce_tags=True>
[2023-05-19 13:23:31,109][src.utils.utils][INFO] - Printing config tree with Rich! <cfg.extras.print_config=True>
[2023-05-19 13:23:31,151][__main__][INFO] - Instantiating datamodule <src.MultiLabel.data.partial_labels_datamodule.PartialMLDataModule>
[2023-05-19 13:23:31,307][__main__][INFO] - Instantiating model <src.MultiLabel.models.Resnet50_module.Resnet50>
[2023-05-19 13:23:31,636][__main__][INFO] - Instantiating callbacks...
[2023-05-19 13:23:31,637][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>
[2023-05-19 13:23:31,639][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>
[2023-05-19 13:23:31,640][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>
[2023-05-19 13:23:31,640][src.utils.instantiatiators][INFO] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>
[2023-05-19 13:23:31,641][__main__][INFO] - Instantiating loggers...
[2023-05-19 13:23:31,641][src.utils.instantiatiators][INFO] - Instantiating logger <pytorch_lightning.loggers.wandb.WandbLogger>
[2023-05-19 13:23:38,605][__main__][INFO] - Instantiating trainer <pytorch_lightning.trainer.Trainer>
[2023-05-19 13:23:38,753][__main__][INFO] - Logging hyperparameters!
[2023-05-19 13:23:38,759][__main__][INFO] - Starting training!
[2023-05-19 15:28:06,622][__main__][INFO] - Starting testing!
[2023-05-19 15:28:50,950][__main__][INFO] - Best ckpt path: /home/dan/LabelNoise/logs/train/runs/2023-05-19_13-23-31/checkpoints/epoch_012.ckpt
[2023-05-19 15:28:50,952][src.utils.utils][INFO] - Output dir: /home/dan/LabelNoise/logs/train/runs/2023-05-19_13-23-31
[2023-05-19 15:28:50,952][src.utils.utils][INFO] - Closing wandb!
[2023-05-19 15:29:00,820][src.utils.utils][INFO] - Metric name is None! Skipping metric value retrieval...
